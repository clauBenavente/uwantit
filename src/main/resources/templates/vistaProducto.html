<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout/layout :: head">
<meta charset="UTF-8">
</head>
<body>
	<header th:replace="layout/layout :: header"></header>

	<div class="container">
		<div class="row">
			<div class="col-md-5 carousel slide" data-ride="carousel">
				<div class="carousel-inner">
					<div class="carousel-item active">
						<img class="card-img-top"
							th:src="@{'/uploads/' + ${producto.fotos}}"
							th:alt="${producto.fotos}" style="width: 100%">
					</div>
					<a class="carousel-control-prev" href="" role="button"
						data-slide="prev"> <span class="carousel-control-prev-icon"
						aria-hidden="true"></span> <span class="sr-only">Previous</span>
					</a> <a class="carousel-control-next" href="" role="button"
						data-slide="next"> <span class="carousel-control-next-icon"
						aria-hidden="true"></span> <span class="sr-only">Next</span>
					</a>
				</div>
			</div>
			<div class="col-md-1">
				<br><a th:if="${editable}" th:href="@{/formularioProducto/} + ${producto.idProducto}">
				<i class="fas fa-edit fa-2x"></i></a>
					<i class="fas fa-trash-alt fa-2x"></i><br> 
					<a th:if="${!favorito}" th:href="@{javascript:void(0)?}" th:onclick="'annadirFavorito(\''+ ${producto.idProducto} +'\')'">
					<i sec:authorize="isAuthenticated()" id="likecorazon"
					class="fa fa-heart fa-2x"></i></a>
					<a th:if="${favorito}" th:href="@{javascript:void(0)?}"
					th:onclick="'quitarFavorito(\''+ ${producto.idProducto} +'\')'">
					<i sec:authorize="isAuthenticated()" id="likecorazon"
					class="fa fa-heart fa-2x text-danger"></i>
				</a> <i sec:authorize="isAuthenticated()" class="fas fa-comments fa-2x"></i>
			</div>
			<div class="col-md-6">
				<h3 th:text="${producto.nombre}"></h3>
				<h3 th:text="${producto.precio} + '&euro;'"></h3>
				<p>
					Categoria del producto: <span
						th:text="${producto.categoriaProducto.descripcion}"></span>
				</p>
				<p th:text="${producto.descripcion}">
				<p th:text="${producto.localizacion}"></p>
				<a th:href="@{/usuario/} + ${producto.usuario.username}"
					class="btn btn-secondary botonUno"
					th:text="${producto.usuario.username}"></a>
			</div>
		</div>
		<br> <a th:href="@{/listar}" class="btn btn-secondary">Atras</a>
	</div>

	<footer th:replace="layout/layout :: footer"></footer>

	<script type="text/javascript">
		function annadirFavorito(idProducto) {
			console.log("producto" + idProducto);
		    fetch("/producto/favorito/" + idProducto)
		        .then((res)=>res.json())
		        .then((res)=>{
		            console.log(res);
		            var corazonEl = document.querySelector("#likecorazon");
		            
		            if (res.estado) {
		                corazonEl.classList.add("text-danger");
		                corazonEl.classList.add("heartBeat");
		            } else {
		                corazonEl.classList.remove("text-danger");
		                corazonEl.classList.remove("heartBeat");
		            }
		        })
		}
		</script>


</body>
</html>